---
layout: post
title: 用apache给gae做反向代理
category: web
---

<a href="http://www.writetofuture.com">写给未来的信</a>这个网站是我在大二暑假时候做的，依托于google免费云计算资源google app engine。

由于G*F*W的存在，ghs.google.com在很早之前就光荣的被墙了，大家都在找ghs的替代品，我最开始用的是you8g的服务，虽然不太稳定，但还是用了好久，直到前一段时间我突然发现writetofuture已经半个月没法访问了，原来是you8g挂了，只好再找替代品。后来又找到了chinasb，和you8g提供一样的服务，连界面都一模一样，用了还没一个礼拜，今天发现chinasb也光荣牺牲了，chinasb牺牲的原因在于google把它封掉了，应该是因为从chinasb转向gae的流量太大了，google可能会怀疑chinasb在对其服务器进行攻击。
别人的免费服务终究是不靠谱的，还得自食其力，自己架反向代理才是根本的解决办法。

其实我很早之前就有打算自己给GAE架反向代理了，但网上的经验都是基于nginx的，而我一直在用apache，悲剧的是我对apache也是略懂皮毛，对于如何在apache上架反向代理完全没有头绪。就这样只好使用you8g这样的免费服务。

chinasb也挂了，我彻底无语了，被逼到绝境了，只好自己架反向代理了。

原本认为会挺困难的，但事实上不到一个小时就弄好了，不过是看看apache的相关文档，自己尝试尝试，其实本应该是非常简单的。

只需要在apache的配置文件中加入如下settting:

NameVirtualHost *:80
< VirtualHost *:80 >
ServerName writetofuture.com
RewriteEngine On
RewriteRule ^(.*)$ http://write-to-future.appspot.com/$1 [P]
< /VirtualHost >
< VirtualHost *:80 >
ServerName www.colorfulcloud.com
< /VirtualHost >

我为writetofuture.com新增了一个virtualhost，采用rewrite模块，只需将来自writetofuture.com的请求定向给GAE的appspot即可，注意最后的规则是[P]，代表proxy，而不是[R]。最后在godaddy面板将writetofuture.com A记录到我的服务器ip地址。

writetofuture这个网站的全部操作都是由后台自动完成的，完全不需要我来维护，事实上GAE的表现也一直不错，信全都按时发出去了，我也很少去管这个网站了。

writetofuture是我做的第一个网站，当时自己还蛮得意的，现在看起来实在是非常丑陋，后台代码写的丑，前端界面设计的丑。毕竟当时没有任何经验，全凭一腔热血边学GAE边做了它。正如我在<a href="http://www.colorfulcloud.com/about/">about页面</a>说的那样“以前写的文章现在看来都很naive，以前写的代码现在看来都很ugly”，这也是我不断进步的标志，如果半年前的我和现在的我完全一样，那才是真正可怕的事。

writetofuture这个网站的访问量虽然不高，但(写信人数/访问量)这个变量还是很大的，这也是让我非常欣慰的，自己做的东西还是有人需要的，写的代码也就有了价值。

writetofuture的用户大都不愿意公开自己的信件，所以普通用户能看到的都是一小部分信件，不公开的信件通常都写的更用心，从字数就可以看出来。（注：我不会去偷看别人的信件，我没那个兴趣也没那个精力）
通过google analytics我发现，writetofuture的流量大多来自百度搜索，可见还真有不少人有给未来写信的愿望，我也一定会把这个网站继续做下去的，反正一年不过几十块的域名费。

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

show一下我今年的课表，无比恐怖，这大学上的比高中都累多了....
<img src="http://iqto9q.blu.livefilestore.com/y1pdxkV0YIA7TstrUWNWuN9J8P70NWv52rLVhXDOfnkq8ySvQ15I2Q-xgy9b3Im9CnpkrNDiMdJ01JeXurJC5SUoLjbBzFv_NCB/%E8%AF%BE%E8%A1%A8.JPG?psid=1" alt="课表">
